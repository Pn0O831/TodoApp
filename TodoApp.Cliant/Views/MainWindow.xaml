<Window x:Class="TodoApp.Client.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="ToDoアプリケーション"
        Height="600" Width="900"
        WindowStartupLocation="CenterScreen">

    <Grid Margin="10">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="651*"/>
            <ColumnDefinition Width="229*"/>
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <!-- 操作バー -->
            <RowDefinition Height="*"/>
            <!-- 一覧 -->
            <RowDefinition Height="Auto"/>
            <!-- ステータス -->
        </Grid.RowDefinitions>

        <!-- 操作バー -->
        <StackPanel Orientation="Horizontal" Grid.Row="0" Margin="0 0 0 10" Grid.ColumnSpan="2">
            <Button Content="＋ 新規登録" Width="120" Margin="0 0 10 0" Click="AddButton_Click"/>
            <TextBlock Text="フィルタ:" VerticalAlignment="Center" Margin="0 0 5 0"/>
            <ComboBox Width="120"
                      ItemsSource="{Binding FilterOptions}"
                      SelectedItem="{Binding SelectedFilter, Mode=TwoWay}"
                      Margin="0 0 10 0"/>
            <Button Content="🔄 更新" Width="80" Click="ReloadButton_Click"/>
        </StackPanel>

        <!-- 一覧 -->
        <DataGrid ItemsSource="{Binding FilteredItems}"
                  Grid.Row="1"
                  AutoGenerateColumns="False"
                  CanUserAddRows="False"
                  HeadersVisibility="Column"
                  Margin="0 0 0 10"
                  Grid.ColumnSpan="2">

            <DataGrid.Columns>
                <DataGridTemplateColumn Header="完了" Width="60">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <CheckBox
                                IsChecked="{Binding IsCompleted,Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"/>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>

                <DataGridTextColumn Binding="{Binding Title}" Header="タイトル" Width="150"/>
                <DataGridTextColumn Binding="{Binding Description}" Header="詳細説明" Width="*"/>
                <DataGridTextColumn Binding="{Binding DueDate, StringFormat=yyyy/MM/dd}" Header="期限" Width="120"/>
                <DataGridTextColumn Binding="{Binding PriorityText}" Header="優先度" Width="80"/>
                <DataGridTemplateColumn Header="操作" Width="120">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                <Button Content="✏️" Width="50" Margin="0 0 5 0"
                                        Command="{Binding DataContext.EditCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                        CommandParameter="{Binding}"/>
                                <Button Content="🗑️" Width="50"
                                        Command="{Binding DataContext.DeleteCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                        CommandParameter="{Binding}"/>
                            </StackPanel>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
            </DataGrid.Columns>
        </DataGrid>

        <!-- ステータス -->
        <TextBlock Text="{Binding StatusText}" Grid.Row="2" FontWeight="Bold" Grid.ColumnSpan="2" Margin="0,10,0,20" Grid.RowSpan="2"/>
    </Grid>
</Window>
